---
title: "mysql的 .ibd文件 过大,清理方案"
date: 2023-07-10T09:39:02+08:00
updated: 2026-02-23T10:24:08+08:00
author: "臭大佬"
categories: [MYSQL]
description: "mysql的 .ibd文件 过大,清理方案"
cover: "https://www.choudalao.com/uploads/20230710/VpGk1m4bTDHVtPNJ5xMxXpoXuykbnquoeT55qSZm.png"
click: 4945
---

# 背景
如果你的 MySQL .ibd 文件很大，但是你的数据库文件大小不太，可能有几个原因：

	数据库文件和 .ibd 文件存储在不同的磁盘上。如果是这种情况，那么你需要清理 .ibd 文件所在的磁盘上的空间。
	数据库中的数据已经被删除了，但是 .ibd 文件中仍然保留着这些数据。这可能是因为 MySQL 并不会在删除数据时立即释放磁盘空间，而是将其标记为可重用的空间。要清理这些空间，可以使用 OPTIMIZE TABLE 命令来重建表，这将释放未使用的空间。
	.ibd 文件可能包含一些临时数据，例如事务回滚期间未被清理的临时数据。这些数据可以通过重启 MySQL 服务来清理。重启服务将关闭所有连接到数据库的进程，并清除 .ibd 文件中的临时数据。

请注意，清理 .ibd 文件可能会导致数据丢失，因此在进行任何操作之前，务必备份数据。

# 方案
使用 OPTIMIZE TABLE 命令来重建表可以释放未使用的空间。以下是具体的操作步骤：

###### 登录 MySQL 服务器。可以使用以下命令：
```go
mysql -u <用户名> -p
```
###### 选择要进行优化的数据库。可以使用以下命令：
```go
use <数据库名>;
```
###### 选择要进行优化的表。可以使用以下命令：
```go
OPTIMIZE TABLE <表名>;
```
这将开始优化指定的表。优化过程可能需要一些时间，具体时间取决于表的大小和服务器性能。

###### 等待优化完成。当优化完成时，MySQL 将显示一条消息，指示表已被优化。你可以使用以下命令来查看表的状态：
```go
SHOW TABLE STATUS LIKE '<表名>';
```
这将显示表的详细信息，包括其大小和行数。如果优化成功，你应该会看到表的大小减小了。

请注意，重建表可能会导致数据丢失，因此在进行任何操作之前，务必备份数据。另外，对于非常大的表，优化过程可能会影响数据库的性能，因此需要在适当的时间进行。

转载自:https://www.cnblogs.com/fanhua999/p/17171623.html