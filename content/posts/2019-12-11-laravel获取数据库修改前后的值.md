---
title: "laravel获取数据库修改前后的值"
date: 2019-12-11T18:45:27+08:00
updated: 2026-02-23T03:28:00+08:00
author: "臭大佬"
categories: [php]
description: "laravel获取数据库修改前后的值"
cover: "https://www.choudalao.com/uploads/20191211/ezpD6bSnkTAnMsKWXCiMXtn7UmGJNt4fcZytAYlg.jpeg"
click: 5041
---

# 前提
使用Eloquent
# 获取方式
```php
if ($article->isDirty('title')) {
	$user = Auth::user()->username;
	$oldTitle = $article->getOriginal('title'); // 原始值
	$newTitle = $article->title;                // 新值
	ActionLog::log("$user 把标题 $oldTitle 修改为 $newTitle");
}
```
# 获取修改字段
`article->getDirty()`可以获取修改的所有字段如下:
```php
dd(article->getDirty());
```

> array:2 [
  "title" => "德玛西亚"
  "updated_at" => "2019-12-11 18:21:04"
]

# 观察者模式

如果用到观察者监听数据变化，一般在数据模型观察者的 updated 方法对修改内容进行监听

```php
/**
     * Handle the article "updated" event.
     *
     * @param \App\Models\Article $article
     * @return void
     */
    public function updated(Article $article)
    {
        if ($article->isDirty('title')) {
            $user     = Auth::user()->username;
            $oldTitle = $article->getOriginal('title'); // 原始值
            $newTitle = $article->title;                // 新值
            ActionLog::log("$user 把标题 $oldTitle 修改为 $newTitle");
        }
    }
```
![](https://www.choudalao.com/uploads/20200731/20200731110813zuevwn.png)