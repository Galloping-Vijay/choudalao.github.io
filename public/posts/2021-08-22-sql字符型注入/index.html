<!DOCTYPE html>
<html class="no-js" lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SQL字符型注入 - 臭大佬博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="SQL字符型注入">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="臭大佬博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">臭大佬博客</div>
					
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">菜单</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">
				
				<span class="menu__text">首页</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/post/">
				
				<span class="menu__text">归档</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about/">
				
				<span class="menu__text">关于</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SQL字符型注入</h1>
			
		</header>
		<div class="content post__content clearfix">
			<h1 id="sql字符型注入">SQL字符型注入</h1>
<p>以pikachu靶场上的字符型注入漏洞为例，根据上一篇<a href="https://www.choudalao.com/article/259" title="《SQL漏洞注入》">《SQL漏洞注入》</a>的思路，我们直接构造如下sql：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">select</span> <span style="color:#a6e22e">字段1，字段2</span> <span style="color:#a6e22e">from</span> <span style="color:#a6e22e">表名</span> <span style="color:#a6e22e">where</span> <span style="color:#a6e22e">username</span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;s&#39;</span> <span style="color:#66d9ef">or</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;
</span></span></code></pre></div><p><em>为了方便查看，这边直接在源代码加了一句打印sql，</em></p>
<p>我们输入<code>s or 1=1</code>,</p>
<p><img src="https://www.choudalao.com/uploads/20210822/20210822180516ptsRzg.png" alt="">
这里直接把<code>s or 1=1</code>用引号引起来作为一个参数了，这不是我们想要的结果，再次尝试输入 <code>s' or 1=1</code> ,查看结果
<img src="https://www.choudalao.com/uploads/20210822/20210822180729rElxUI.png" alt=""></p>
<p>mysql数据库对于单引号的规则如下：</p>
<blockquote>
<p>单引号必须成对出现，否则数据库就会报错。
如果两个单引号之间内容为空，数据库自动忽略。</p>
</blockquote>
<p>这时候报错了，由这个提示可以看出，是sql语句单引号没有闭合，可以猜想语句大致如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">select</span> <span style="color:#a6e22e">字段1，字段2</span> <span style="color:#a6e22e">from</span> <span style="color:#a6e22e">表名</span> <span style="color:#a6e22e">where</span> <span style="color:#a6e22e">username</span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;s&#39;</span> <span style="color:#66d9ef">or</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>;
</span></span></code></pre></div><p>我们可以巧用注释来把最后那个单引号注释掉，输入<code>s' or 1=1#</code>，sql语句如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">select</span> <span style="color:#a6e22e">字段1，字段2</span> <span style="color:#a6e22e">from</span> <span style="color:#a6e22e">表名</span> <span style="color:#a6e22e">where</span> <span style="color:#a6e22e">username</span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;s&#39;</span> <span style="color:#66d9ef">or</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#75715e">#;
</span></span></span></code></pre></div><p>执行查看结果：</p>
<p><img src="https://www.choudalao.com/uploads/20210822/202108221813172xoRK9.png" alt=""></p>
<h1 id="判断输入是否参与数据库的逻辑运算">判断输入是否参与数据库的逻辑运算</h1>
<h3 id="方式一">方式一</h3>
<p>测试单引号或者双引号，查看是否有报错信息。如出现类似如下提示，表明存在攻击点。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">You</span> <span style="color:#a6e22e">have</span> <span style="color:#a6e22e">an</span> <span style="color:#a6e22e">error</span> <span style="color:#a6e22e">in</span> <span style="color:#a6e22e">your</span> <span style="color:#a6e22e">SQL</span> <span style="color:#a6e22e">syntax</span>; <span style="color:#a6e22e">check</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">manual</span> <span style="color:#a6e22e">that</span> <span style="color:#a6e22e">corresponds</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">your</span> <span style="color:#a6e22e">MySQL</span> <span style="color:#a6e22e">server</span> <span style="color:#a6e22e">version</span> <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">right</span> <span style="color:#a6e22e">syntax</span> <span style="color:#a6e22e">to</span> <span style="color:#66d9ef">use</span> <span style="color:#a6e22e">near</span> <span style="color:#e6db74">&#39;&#39;&#39;&#39;</span><span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#a6e22e">at</span> <span style="color:#a6e22e">line</span> <span style="color:#ae81ff">1</span>
</span></span></code></pre></div><h3 id="方式二">方式二</h3>
<p><code>1=1</code>为真，<code>1=2</code>为假，我们在我们输入中拼接上这两个字符串，如果结果有变化，说明输入参与了数据库逻辑运算，那就存在攻击的可能，</p>
<h4 id="测试">测试</h4>
<p>以上面的栗子，我们分别输入<code>s or 1=1#</code> 和 <code>'s or 1=2#</code>，发现1=2不出结果，说明输入有参加逻辑运算。</p>
<p><img src="https://www.choudalao.com/uploads/20210822/202108221916225WiyG1.png" alt=""></p>
<p>总而言之，不管是哪个一种类型的SQL，我们的做法就是对SQL中的各种类型的输入进行闭合测试，构造合法SQL，欺骗后台执行。</p>

		</div>
	</article>
</main>




			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2026 臭大佬博客.
			<span class="footer__copyright-credits">基于 <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> 引擎和 <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> 主题</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>