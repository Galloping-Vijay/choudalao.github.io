<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>使用文件存储数据 | 臭大佬 - 臭大佬博客</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content="在日常工作和学习中，我们经常使用文件来存储数据，比如复制粘贴一段精彩的网络文摘保存到
txt 文件中，比如在 Excel 中进行报表记录。"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/choudalao.github.io/css/style.css><link rel="shortcut icon" href=/choudalao.github.io/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/choudalao.github.io/ title=臭大佬博客 rel=home><div class="logo__item logo__text"><div class=logo__title>臭大佬博客</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>菜单</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/choudalao.github.io/><span class=menu__text>首页</span></a></li><li class=menu__item><a class=menu__link href=/choudalao.github.io/post/><span class=menu__text>归档</span></a></li><li class=menu__item><a class=menu__link href=/choudalao.github.io/about/><span class=menu__text>关于</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>使用文件存储数据 | 臭大佬</h1></header><div class="content post__content clearfix"><h1 id=创建一个空文件>创建一个空文件：</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>mknod(<span style=color:#e6db74>&#34;test.txt&#34;</span>)
</span></span></code></pre></div><h1 id=打开一个文件>打开一个文件：</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>file <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;test.txt&#39;</span>)
</span></span></code></pre></div><h3 id=关于-open函数对文件的打开模式>关于 open()函数对文件的打开模式：</h3><ul><li>w：以写方式打开</li><li>a：以追加模式打开 (从 EOF 开始, 必要时创建新文件)</li><li>r+：以读写模式打开</li><li>w+：以读写模式打开</li><li>a+：以读写模式打开</li><li>rb：以二进制读模式打开</li><li>wb：以二进制写模式打开</li><li>ab：以二进制追加模式打开</li><li>rb+：以二进制读写模式打开</li><li>wb+：以二进制读写模式打开</li><li>ab+：以二进制读写模式打开</li></ul><h3 id=读取文件内容>读取文件内容</h3><ul><li>file.read([size])：size 为读取的长度，以 byte 为单位</li><li>file.readline([size]) ：读一行，如果定义了 size，有可能返回的只是一行的一部分</li><li>file.readlines([size]) ：把文件每一行作为一个 list 的一个成员，并返回这个 list。其实它的内部是通过循环调用 readline()来实现的。如果提供 size 参数，表示读取内容的总长，也就是说可能只读到文件的一部分。</li></ul><h3 id=写入文件>写入文件</h3><ul><li>file.write(str) ：把 str 写到文件中，write()并不会在 str 后加上一个换行符</li><li>file.writelines(seq)：把 seq 的内容全部写到文件中(多行一次性写入)，既接受一个字符串，</li><li>也接受一个字符串序列。</li></ul><h3 id=关闭文件>关闭文件</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>file<span style=color:#f92672>.</span>close()
</span></span></code></pre></div><p>除了使用 close()方法对文件进行显示的关闭。我们还能够借助 Python 提供的资源访问控制功能
with…as 实现文件的打开和关闭：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;test.txt&#39;</span>,<span style=color:#e6db74>&#39;w&#39;</span>) <span style=color:#66d9ef>as</span> file:
</span></span><span style=display:flex><span>data <span style=color:#f92672>=</span> file<span style=color:#f92672>.</span>read()
</span></span></code></pre></div><p>以上代码就使用了文件的打开、读取和关闭。</p><h3 id=栗子>栗子</h3><p>我们来爬取长汀二手房的信息，代码有点粗糙，后期优化。
<img src=https://www.choudalao.com/uploads/20200316/20200316222000GpzGA3.png alt></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># coding:utf-8</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 引入相关模块</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> bs4 <span style=color:#f92672>import</span> BeautifulSoup
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;http://house.366300.com/houselist.asp?type=sale&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 请求腾讯新闻的 URL，获取其 text 文本</span>
</span></span><span style=display:flex><span>wbdata <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(url)
</span></span><span style=display:flex><span>wbdata<span style=color:#f92672>.</span>encoding <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;gbk&#39;</span>  <span style=color:#75715e># 将编码格式改为utf-8</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 对获取到的文本进行解析</span>
</span></span><span style=display:flex><span>soup <span style=color:#f92672>=</span> BeautifulSoup(wbdata<span style=color:#f92672>.</span>text, <span style=color:#e6db74>&#39;lxml&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># 从解析文件中通过 select 选择器定位指定的元素，返回一个列表</span>
</span></span><span style=display:flex><span>ids <span style=color:#f92672>=</span> soup<span style=color:#f92672>.</span>select(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;table.bk &gt; tr&gt; td:nth-child(2)&gt; table:nth-child(4)&gt;tr&gt;td&gt;table&gt;tr&gt;td&gt;table&gt;tr&gt;td&gt;table&gt;tr&gt;td:nth-child(1)&gt;div&gt;p&gt;font&gt;span&#34;</span>)
</span></span><span style=display:flex><span>areas <span style=color:#f92672>=</span> soup<span style=color:#f92672>.</span>select(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;table.bk &gt; tr&gt; td:nth-child(2)&gt; table:nth-child(4)&gt;tr&gt;td&gt;table&gt;tr&gt;td&gt;table&gt;tr&gt;td&gt;table&gt;tr&gt;td:nth-child(2)&gt;div&gt;span&#34;</span>)
</span></span><span style=display:flex><span>address <span style=color:#f92672>=</span> soup<span style=color:#f92672>.</span>select(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;table.bk &gt; tr&gt; td:nth-child(2)&gt; table:nth-child(4)&gt;tr&gt;td&gt;table&gt;tr&gt;td&gt;table&gt;tr&gt;td&gt;table&gt;tr&gt;td:nth-child(3)&gt;div&gt;span&gt;a&gt;font&#34;</span>)
</span></span><span style=display:flex><span>types <span style=color:#f92672>=</span> soup<span style=color:#f92672>.</span>select(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;table.bk &gt; tr&gt; td:nth-child(2)&gt; table:nth-child(4)&gt;tr&gt;td&gt;table&gt;tr&gt;td&gt;table&gt;tr&gt;td&gt;table&gt;tr&gt;td:nth-child(4)&gt;div&gt;span&#34;</span>)
</span></span><span style=display:flex><span>prices <span style=color:#f92672>=</span> soup<span style=color:#f92672>.</span>select(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;table.bk &gt; tr&gt; td:nth-child(2)&gt; table:nth-child(4)&gt;tr&gt;td&gt;table&gt;tr&gt;td&gt;table&gt;tr&gt;td&gt;table&gt;tr&gt;td:nth-child(5)&gt;div&gt;span&#34;</span>)
</span></span><span style=display:flex><span>times <span style=color:#f92672>=</span> soup<span style=color:#f92672>.</span>select(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;table.bk &gt; tr&gt; td:nth-child(2)&gt; table:nth-child(4)&gt;tr&gt;td&gt;table&gt;tr&gt;td&gt;table&gt;tr&gt;td&gt;table&gt;tr&gt;td:nth-child(6)&gt;div&gt;span&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>dict <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(ids)):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(ids) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>30</span>:
</span></span><span style=display:flex><span>        id_i <span style=color:#f92672>=</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        id_i <span style=color:#f92672>=</span> i
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(areas) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>30</span>:
</span></span><span style=display:flex><span>        area_i <span style=color:#f92672>=</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        area_i <span style=color:#f92672>=</span> i
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(address) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>30</span>:
</span></span><span style=display:flex><span>        addres_i <span style=color:#f92672>=</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        addres_i <span style=color:#f92672>=</span> i
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(types) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>30</span>:
</span></span><span style=display:flex><span>        type_i <span style=color:#f92672>=</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        type_i <span style=color:#f92672>=</span> i
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(prices) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>30</span>:
</span></span><span style=display:flex><span>        price_i <span style=color:#f92672>=</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        price_i <span style=color:#f92672>=</span> i
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(times) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>30</span>:
</span></span><span style=display:flex><span>        time_i <span style=color:#f92672>=</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        time_i <span style=color:#f92672>=</span> i
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    id <span style=color:#f92672>=</span> ids[id_i]<span style=color:#f92672>.</span>get_text()<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>    area <span style=color:#f92672>=</span> areas[area_i]<span style=color:#f92672>.</span>get_text()<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>    addres <span style=color:#f92672>=</span> address[addres_i]<span style=color:#f92672>.</span>get_text()<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>    type <span style=color:#f92672>=</span> types[type_i]<span style=color:#f92672>.</span>get_text()<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>    price <span style=color:#f92672>=</span> prices[price_i]<span style=color:#f92672>.</span>get_text()<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>    time <span style=color:#f92672>=</span> times[time_i]<span style=color:#f92672>.</span>get_text()<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>    data <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;id&#39;</span>: id,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;area&#39;</span>: area,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;addres&#39;</span>: addres,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;type&#39;</span>: type,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;price&#39;</span>: price,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;time&#39;</span>: time,
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    dict[i] <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    dict[i]<span style=color:#f92672>.</span>append(data)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;listings.txt&#39;</span>, <span style=color:#e6db74>&#39;a+&#39;</span>, encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>) <span style=color:#66d9ef>as</span> files:
</span></span><span style=display:flex><span>    <span style=color:#75715e># 对返回的列表进行遍历</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> n <span style=color:#f92672>in</span> dict:
</span></span><span style=display:flex><span>        str <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;编号:&#39;</span> <span style=color:#f92672>+</span> dict[n][<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#39;id&#39;</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;，&#39;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;区域：&#39;</span> <span style=color:#f92672>+</span> dict[n][<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#39;area&#39;</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;，&#39;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;地点：&#39;</span> <span style=color:#f92672>+</span> dict[n][<span style=color:#ae81ff>0</span>][
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;addres&#39;</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;，&#39;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;类型：&#39;</span> <span style=color:#f92672>+</span> dict[n][<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#39;type&#39;</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;，&#39;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;价格：&#39;</span> <span style=color:#f92672>+</span> dict[n][<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#39;price&#39;</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;，&#39;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;发布时间：&#39;</span> <span style=color:#f92672>+</span> dict[n][<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#39;time&#39;</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span>        files<span style=color:#f92672>.</span>write(str)
</span></span></code></pre></div><p>结果：
<img src=https://www.choudalao.com/uploads/20200316/20200316222108WW2gvo.png alt></p></div></article></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2026 臭大佬博客.
<span class=footer__copyright-credits>基于 <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> 引擎和 <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> 主题</span></div></div></footer></div><script async defer src=/choudalao.github.io/js/menu.js></script></body></html>