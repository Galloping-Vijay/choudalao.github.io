<!doctype html><html class=no-js lang=en><head><meta name=generator content="Hugo 0.156.0"><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>臭大佬博客</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content="技术博客"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/choudalao.github.io/css/style.css><link rel=alternate type=application/rss+xml href=/choudalao.github.io/index.xml title=臭大佬博客><link rel="shortcut icon" href=/choudalao.github.io/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/choudalao.github.io/ title=臭大佬博客 rel=home><div class="logo__item logo__text"><div class=logo__title>臭大佬博客</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>菜单</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/choudalao.github.io/><span class=menu__text>首页</span></a></li><li class=menu__item><a class=menu__link href=/choudalao.github.io/posts/><span class=menu__text>归档</span></a></li><li class=menu__item><a class=menu__link href=/choudalao.github.io/about/><span class=menu__text>关于</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class="main list" role=main><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/choudalao.github.io/posts/2023-07-30-go-%E8%8E%B7%E5%8F%96ip%E6%A0%B9%E6%8D%AEip%E8%8E%B7%E5%8F%96%E5%9C%B0%E7%90%86%E4%BD%8D%E7%BD%AE%E4%BF%A1%E6%81%AF/ rel=bookmark>go 获取IP，根据IP获取地理位置信息</a></h2></header><div class="content list__excerpt post__content clearfix"><h1 id=获取ip>获取ip</h1><h2 id=gin框架获取客户端ip>gin框架获取客户端IP</h2><p>在Gin框架中，你可以使用c.ClientIP()方法来获取客户端的IP地址。该方法返回一个字符串，表示客户端的IP地址。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// 获取客户端IP地址 c 为 *gin.Context</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ip</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>ClientIP</span>()
</span></span></code></pre></div><h2 id=获取公网ip>获取公网ip</h2><p>可以用公开的接口<code>ipify</code>，通过发送HTTP请求来获取当前设备的公网IP地址。</p></div></article><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/choudalao.github.io/posts/2023-07-10-mysql%E7%9A%84-ibd%E6%96%87%E4%BB%B6-%E8%BF%87%E5%A4%A7%E6%B8%85%E7%90%86%E6%96%B9%E6%A1%88/ rel=bookmark>mysql的 .ibd文件 过大,清理方案</a></h2></header><div class="content list__excerpt post__content clearfix"><h1 id=背景>背景</h1><p>如果你的 MySQL .ibd 文件很大，但是你的数据库文件大小不太，可能有几个原因：</p><pre><code>数据库文件和 .ibd 文件存储在不同的磁盘上。如果是这种情况，那么你需要清理 .ibd 文件所在的磁盘上的空间。
数据库中的数据已经被删除了，但是 .ibd 文件中仍然保留着这些数据。这可能是因为 MySQL 并不会在删除数据时立即释放磁盘空间，而是将其标记为可重用的空间。要清理这些空间，可以使用 OPTIMIZE TABLE 命令来重建表，这将释放未使用的空间。
.ibd 文件可能包含一些临时数据，例如事务回滚期间未被清理的临时数据。这些数据可以通过重启 MySQL 服务来清理。重启服务将关闭所有连接到数据库的进程，并清除 .ibd 文件中的临时数据。
</code></pre><p>请注意，清理 .ibd 文件可能会导致数据丢失，因此在进行任何操作之前，务必备份数据。</p></div></article><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/choudalao.github.io/posts/2023-05-17-git%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/ rel=bookmark>git开发规范</a></h2></header><div class="content list__excerpt post__content clearfix"><h1 id=git开发规范>git开发规范</h1><p>master分支：线上分支，不允许随意提交修改，仅允许develop分支合并，仅管理员操作;
develop：为开发分支,所有分支都应该从该分支进行检出;
release：测试分支,对应测试环境,当功能开发完成,要进行测试时,把代码推送至该分支,该分支只能推送,不能合并到自己的分支;
feature-名字：程序员开发使用的功能分支，从develop上检出的开发分支
##开发流程:
每个任务或缺陷,都应该拉取单独的分支进行开发!
###创建分支
当开始开发一个任务时,以tapd的任务id作为分支名,如 &ldquo;【ID1000536】【手机端】&ndash;聊天室&ndash;弹幕功能自定义&rdquo;,那么任务分支名为 ID1000536,如果是修复缺陷,那么以缺陷id作为分支名,如分支名: ID1000536,应该切换到develop分支,拉取最新代码,.然后在develop分支基础上创建任务(bug)分支.
###任务完成发布测试
当任务完成,把任务分支合并到 release分支, release分支对应测试环境,不能将release分支合并到自己的分支.</p></div></article><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/choudalao.github.io/posts/2023-05-15-docker-%E6%89%93%E5%8C%85%E6%8E%A8%E9%80%81-%E9%92%A9%E5%AD%90%E6%9B%B4%E6%96%B0%E6%B5%8B%E8%AF%95%E7%AB%99%E5%AE%B9%E5%99%A8/ rel=bookmark>docker 打包推送 + 钩子更新测试站容器</a></h2></header><div class="content list__excerpt post__content clearfix"><h1 id=问题>问题</h1><p>刚开始测试站更新的流程如下:</p><ul><li>本地构建<code>go</code>项目</li><li>本地打包镜像</li><li>本地推送镜像库</li><li>到测试服务器上,拉取镜像</li></ul><p>每次都要这么繁琐的操作,也是有点累,所以准备做一个升级,一步到位,思路如下
本地写一个脚本,主要是为了构建项目和推送镜像到远程仓库,然后测试站通过钩子触发更新镜像.</p></div></article><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/choudalao.github.io/posts/2023-05-03-%E5%A4%87%E4%BB%BDdocker%E4%B8%AD%E7%9A%84mysql8%E6%95%B0%E6%8D%AE%E5%88%B0%E6%9C%AC%E5%9C%B0/ rel=bookmark>备份docker中的mysql8数据到本地</a></h2></header><div class="content list__excerpt post__content clearfix"><h1 id=摘要>摘要</h1><p>如果没有备份，数据误操作将是灾难性的事件，作为开发要做好数据备份的习惯。最近测试数据库就被误操作了，导致运营辛辛苦苦上传的数据全没了。</p><h1 id=原理>原理</h1><p>命令行的方式较为快捷。仅仅须要在命令行中使用<code>mysqldump</code>命令,命令如下:</p></div></article><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/choudalao.github.io/posts/2023-03-21-go%E8%AF%AD%E8%A8%80%E4%BD%8D%E6%95%B0%E4%B8%8D%E5%A4%9F%E5%9C%A8%E5%B7%A6%E4%BE%A7%E5%A1%AB%E5%85%850/ rel=bookmark>go语言位数不够在左侧填充0</a></h2></header><div class="content list__excerpt post__content clearfix"><h1 id=问题>问题</h1><p>有时候为了保持位数对齐,我们需要在字符串中填充0或者其他的某个变量,来达到位数对齐的要求,比如,我们拿到的时分秒为1 : 5 : 30,我们想要的格式是01 : 05 : 30,这时候就需要填充了。</p></div></article><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/choudalao.github.io/posts/2023-03-13-%E6%B8%85%E7%90%86-docker-%E5%8D%A0%E7%94%A8%E7%9A%84%E7%A3%81%E7%9B%98%E7%A9%BA%E9%97%B4/ rel=bookmark>清理 docker 占用的磁盘空间</a></h2></header><div class="content list__excerpt post__content clearfix"><h1 id=问题>问题</h1><p>Docker 很占用空间，每当我们运行容器、拉取镜像、部署应用、构建自己的镜像时，我们的磁盘空间会被大量占用。</p><p>如果你也被这个问题所困扰，咱们就一起看一下 Docker 是如何使用磁盘空间的，以及如何回收。</p></div></article><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/choudalao.github.io/posts/2023-03-13-docker-%E5%AF%BC%E8%87%B4-windows-%E7%B3%BB%E7%BB%9F-c-%E7%9B%98%E7%88%86%E6%BB%A1/ rel=bookmark>docker 导致 windows 系统 C 盘爆满</a></h2></header><div class="content list__excerpt post__content clearfix"><h1 id=问题>问题</h1><p>今天发现电脑C盘爆红,找了一下大文件,发现是名为<code>ext4.vhdx</code>的文件,这个是与<code>docker</code>相关的文件,由于在<code>Linux</code>中下载安装各种软件、<code>Docker Image</code>，运行多个<code>Docker Container</code> 导致C盘空间严重不足。</p></div></article><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/choudalao.github.io/posts/2023-03-06-docker-%E5%AE%89%E8%A3%85-kafka/ rel=bookmark>docker 安装 kafka</a></h2></header><div class="content list__excerpt post__content clearfix"><h1 id=说明>说明</h1><p>到 <a href="https://hub.docker.com/search?q=kafka" title="docker hub">docker hub</a> 去搜一下<code>kafka</code>, 排在第一位的是<code>bitnami/kafka</code>,我们就用它了。</p><h3 id=下载-docker-composeyml>下载 docker-compose.yml</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>curl</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>sSL</span> <span style=color:#a6e22e>https</span>:<span style=color:#75715e>//raw.githubusercontent.com/bitnami/containers/main/bitnami/kafka/docker-compose.yml &gt; docker-compose.yml</span>
</span></span></code></pre></div><h3 id=修改-docker-composeyml-配置外网访问>修改 docker-compose.yml ,配置外网访问</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>version</span>: <span style=color:#e6db74>&#34;2&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>zookeeper</span>:
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>image</span>: <span style=color:#a6e22e>docker</span>.<span style=color:#a6e22e>io</span><span style=color:#f92672>/</span><span style=color:#a6e22e>bitnami</span><span style=color:#f92672>/</span><span style=color:#a6e22e>zookeeper</span>:<span style=color:#ae81ff>3.8</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ports</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>-</span> <span style=color:#e6db74>&#34;2181:2181&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>volumes</span>:
</span></span><span style=display:flex><span>       <span style=color:#f92672>-</span> <span style=color:#e6db74>&#34;zookeeper_data:/bitnami&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>environment</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>-</span> <span style=color:#a6e22e>ALLOW_ANONYMOUS_LOGIN</span>=<span style=color:#a6e22e>yes</span> <span style=color:#960050;background-color:#1e0010>#</span> <span style=color:#a6e22e>匿名登录</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>kafka</span>:
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>image</span>: <span style=color:#a6e22e>docker</span>.<span style=color:#a6e22e>io</span><span style=color:#f92672>/</span><span style=color:#a6e22e>bitnami</span><span style=color:#f92672>/</span><span style=color:#a6e22e>kafka</span>:<span style=color:#ae81ff>3.4</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ports</span>: <span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>记得在防火墙开放端口</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>-</span> <span style=color:#e6db74>&#34;9092:9092&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>-</span> <span style=color:#e6db74>&#34;9093:9093&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>volumes</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>-</span> <span style=color:#e6db74>&#34;kafka_data:/bitnami&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>environment</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>-</span> <span style=color:#a6e22e>KAFKA_CFG_ZOOKEEPER_CONNECT</span>=<span style=color:#a6e22e>zookeeper</span>:<span style=color:#ae81ff>2181</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>-</span> <span style=color:#a6e22e>ALLOW_PLAINTEXT_LISTENER</span>=<span style=color:#a6e22e>yes</span> <span style=color:#960050;background-color:#1e0010>#</span> <span style=color:#a6e22e>配置监听者的安全协议</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>-</span> <span style=color:#a6e22e>KAFKA_CFG_LISTENER_SECURITY_PROTOCOL_MAP</span>=<span style=color:#a6e22e>CLIENT</span>:<span style=color:#a6e22e>PLAINTEXT</span>,<span style=color:#a6e22e>EXTERNAL</span>:<span style=color:#a6e22e>PLAINTEXT</span> <span style=color:#960050;background-color:#1e0010>#</span> <span style=color:#a6e22e>定义Kafka</span> <span style=color:#a6e22e>Broker的Listener的配置项</span><span style=color:#960050;background-color:#1e0010>，</span><span style=color:#a6e22e>配置外部访问和内部访问</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>-</span> <span style=color:#a6e22e>KAFKA_CFG_LISTENERS</span>=<span style=color:#a6e22e>CLIENT</span>:<span style=color:#75715e>//:9092,EXTERNAL://0.0.0.0:9093 # 将Broker的Listener信息发布到Zookeeper中，供Clients（Producer/Consumer）使用</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>-</span> <span style=color:#a6e22e>KAFKA_CFG_ADVERTISED_LISTENERS</span>=<span style=color:#a6e22e>CLIENT</span>:<span style=color:#75715e>//kafka:9092,EXTERNAL://dev.wsl.net:9093 # dev.wsl.net 换成自己的ip</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>-</span> <span style=color:#a6e22e>KAFKA_CFG_INTER_BROKER_LISTENER_NAME</span>=<span style=color:#a6e22e>CLIENT</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>depends_on</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>-</span> <span style=color:#a6e22e>zookeeper</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>volumes</span>:
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>zookeeper_data</span>:
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>driver</span>: <span style=color:#a6e22e>local</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>kafka_data</span>:
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>driver</span>: <span style=color:#a6e22e>local</span>
</span></span></code></pre></div><p>运行</p></div></article><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/choudalao.github.io/posts/2023-02-10-%E9%99%90%E5%88%B6-wsl2-%E4%B8%AD-vmmem-%E7%9A%84%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8/ rel=bookmark>限制 WSL2 中 Vmmem 的内存占用</a></h2></header><div class="content list__excerpt post__content clearfix"><h1 id=vmmem内存占用大原因是什么>vmmem内存占用大，原因是什么？</h1><p>当计算机在使用时，CPU会将需要操作的数据传输到内存中进行操作，然后在操作完成后传递结果。
WSL2（Linux 的 Windows 子系统）即使在不需要时也会保留大量RAM。它可以消耗 Windows 上总内存的 50% 或 8GB，以较小者为准；在 20175 之前的版本上：Windows 上总内存的 80%。
Vmmem 负责虚拟机进程和内存管理。这意味着进程是虚拟机跳动的心脏，Vmmem 的所有活动和应用程序都在此发生。
用户设置具有大量内存和 CPU 的虚拟机是 Vmmem 需要大量内存的主要原因，因为这通常会导致他们消耗所有可用资源。</p></div></article></main><div class=pagination><a class="pagination__item pagination__item--prev btn" href=/choudalao.github.io/page/3/>«</a>
<span class="pagination__item pagination__item--current">4/35</span>
<a class="pagination__item pagination__item--next btn" href=/choudalao.github.io/page/5/>»</a></div></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2026 臭大佬博客.
<span class=footer__copyright-credits>基于 <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> 引擎和 <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> 主题</span></div></div></footer></div><script async defer src=/choudalao.github.io/js/menu.js></script></body></html>