<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>MYSQL on 臭大佬博客</title><link>https://galloping-vijay.github.io/choudalao.github.io/categories/mysql/</link><description>Recent content in MYSQL on 臭大佬博客</description><generator>Hugo</generator><language>zh-CN</language><lastBuildDate>Sat, 12 Aug 2023 13:58:42 +0800</lastBuildDate><atom:link href="https://galloping-vijay.github.io/choudalao.github.io/categories/mysql/index.xml" rel="self" type="application/rss+xml"/><item><title>游戏排行榜</title><link>https://galloping-vijay.github.io/choudalao.github.io/posts/2023-08-12-%E6%B8%B8%E6%88%8F%E6%8E%92%E8%A1%8C%E6%A6%9C/</link><pubDate>Sat, 12 Aug 2023 13:58:42 +0800</pubDate><guid>https://galloping-vijay.github.io/choudalao.github.io/posts/2023-08-12-%E6%B8%B8%E6%88%8F%E6%8E%92%E8%A1%8C%E6%A6%9C/</guid><description>&lt;h1 id="问题"&gt;问题&lt;/h1&gt;
&lt;p&gt;一场游戏活动，很多用户一起参与，每个用户都能参与多次，现在要获取得分排行榜，当点数相同的情况下，先出点数的用户赢,同时同一用户相同点数的多条记录,取最先的那条.&lt;/p&gt;</description></item><item><title>mysql的 .ibd文件 过大,清理方案</title><link>https://galloping-vijay.github.io/choudalao.github.io/posts/2023-07-10-mysql%E7%9A%84-ibd%E6%96%87%E4%BB%B6-%E8%BF%87%E5%A4%A7%E6%B8%85%E7%90%86%E6%96%B9%E6%A1%88/</link><pubDate>Mon, 10 Jul 2023 09:39:02 +0800</pubDate><guid>https://galloping-vijay.github.io/choudalao.github.io/posts/2023-07-10-mysql%E7%9A%84-ibd%E6%96%87%E4%BB%B6-%E8%BF%87%E5%A4%A7%E6%B8%85%E7%90%86%E6%96%B9%E6%A1%88/</guid><description>&lt;h1 id="背景"&gt;背景&lt;/h1&gt;
&lt;p&gt;如果你的 MySQL .ibd 文件很大，但是你的数据库文件大小不太，可能有几个原因：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;数据库文件和 .ibd 文件存储在不同的磁盘上。如果是这种情况，那么你需要清理 .ibd 文件所在的磁盘上的空间。
数据库中的数据已经被删除了，但是 .ibd 文件中仍然保留着这些数据。这可能是因为 MySQL 并不会在删除数据时立即释放磁盘空间，而是将其标记为可重用的空间。要清理这些空间，可以使用 OPTIMIZE TABLE 命令来重建表，这将释放未使用的空间。
.ibd 文件可能包含一些临时数据，例如事务回滚期间未被清理的临时数据。这些数据可以通过重启 MySQL 服务来清理。重启服务将关闭所有连接到数据库的进程，并清除 .ibd 文件中的临时数据。
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;请注意，清理 .ibd 文件可能会导致数据丢失，因此在进行任何操作之前，务必备份数据。&lt;/p&gt;</description></item><item><title>备份docker中的mysql8数据到本地</title><link>https://galloping-vijay.github.io/choudalao.github.io/posts/2023-05-03-%E5%A4%87%E4%BB%BDdocker%E4%B8%AD%E7%9A%84mysql8%E6%95%B0%E6%8D%AE%E5%88%B0%E6%9C%AC%E5%9C%B0/</link><pubDate>Wed, 03 May 2023 11:40:06 +0800</pubDate><guid>https://galloping-vijay.github.io/choudalao.github.io/posts/2023-05-03-%E5%A4%87%E4%BB%BDdocker%E4%B8%AD%E7%9A%84mysql8%E6%95%B0%E6%8D%AE%E5%88%B0%E6%9C%AC%E5%9C%B0/</guid><description>&lt;h1 id="摘要"&gt;摘要&lt;/h1&gt;
&lt;p&gt;如果没有备份，数据误操作将是灾难性的事件，作为开发要做好数据备份的习惯。最近测试数据库就被误操作了，导致运营辛辛苦苦上传的数据全没了。&lt;/p&gt;
&lt;h1 id="原理"&gt;原理&lt;/h1&gt;
&lt;p&gt;命令行的方式较为快捷。仅仅须要在命令行中使用&lt;code&gt;mysqldump&lt;/code&gt;命令,命令如下:&lt;/p&gt;</description></item><item><title>mysql 分组查询最新一条数据</title><link>https://galloping-vijay.github.io/choudalao.github.io/posts/2022-06-21-mysql-%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2%E6%9C%80%E6%96%B0%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE/</link><pubDate>Tue, 21 Jun 2022 12:05:10 +0800</pubDate><guid>https://galloping-vijay.github.io/choudalao.github.io/posts/2022-06-21-mysql-%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2%E6%9C%80%E6%96%B0%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE/</guid><description>&lt;h1 id="需求"&gt;需求&lt;/h1&gt;
&lt;p&gt;下面是一张日志表&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a6e22e"&gt;CREATE&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;TABLE&lt;/span&gt; &lt;span style="color:#e6db74"&gt;`user_audit_log`&lt;/span&gt; (
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;`id`&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;int&lt;/span&gt;(&lt;span style="color:#ae81ff"&gt;10&lt;/span&gt;) &lt;span style="color:#a6e22e"&gt;unsigned&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;AUTO_INCREMENT&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;`user_id`&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;int&lt;/span&gt;(&lt;span style="color:#ae81ff"&gt;10&lt;/span&gt;) &lt;span style="color:#a6e22e"&gt;unsigned&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;user表主键&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;`status`&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;tinyint&lt;/span&gt;(&lt;span style="color:#ae81ff"&gt;2&lt;/span&gt;) &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;审核状态1: 通过 2:不通过&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;`reason`&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;varchar&lt;/span&gt;(&lt;span style="color:#ae81ff"&gt;2048&lt;/span&gt;) &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;审核不通过原因&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;`auditor_id`&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;int&lt;/span&gt;(&lt;span style="color:#ae81ff"&gt;10&lt;/span&gt;) &lt;span style="color:#a6e22e"&gt;unsigned&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;sys_users表主键&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;`updated_at`&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;datetime&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;CURRENT_TIMESTAMP&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;ON&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;UPDATE&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;CURRENT_TIMESTAMP&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;`created_at`&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;datetime&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;CURRENT_TIMESTAMP&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#a6e22e"&gt;PRIMARY&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;KEY&lt;/span&gt; (&lt;span style="color:#e6db74"&gt;`id`&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#a6e22e"&gt;KEY&lt;/span&gt; &lt;span style="color:#e6db74"&gt;`idx_uid`&lt;/span&gt; (&lt;span style="color:#e6db74"&gt;`user_id`&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;) &lt;span style="color:#a6e22e"&gt;ENGINE&lt;/span&gt;&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;InnoDB&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;AUTO_INCREMENT&lt;/span&gt;&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;235&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;CHARSET&lt;/span&gt;&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;utf8mb4&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;COMMENT&lt;/span&gt;&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;用户入驻审核记录表&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;现在要查询每个用户状态为3的，最新一条数据；&lt;/p&gt;
&lt;p&gt;可能我们第一时间想到的就是，先对&lt;code&gt;id&lt;/code&gt;进行倒叙，然后&lt;code&gt;group&lt;/code&gt;一下 &lt;code&gt;user_id&lt;/code&gt;,&lt;code&gt;sql&lt;/code&gt;如下：&lt;/p&gt;</description></item><item><title>mysql读写分离</title><link>https://galloping-vijay.github.io/choudalao.github.io/posts/2021-04-01-mysql%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB/</link><pubDate>Thu, 01 Apr 2021 12:05:47 +0800</pubDate><guid>https://galloping-vijay.github.io/choudalao.github.io/posts/2021-04-01-mysql%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB/</guid><description>&lt;h1 id="摘要"&gt;摘要&lt;/h1&gt;
&lt;p&gt;读写分离，基本的原理是让主数据库处理事务性增、改、删操作（INSERT、UPDATE、DELETE），
而从数据库处理 SELECT 查询操作。 数据库复制被用来把事务性操作导致的变更同步到集群中的从数据库。
至少两台数据库服务器，可以分别设置主服务器和从服务器，对主服务器的任何操作都会同步到从服务器上&lt;/p&gt;</description></item><item><title>【转】mysql千万数据级分表设计及实现方案</title><link>https://galloping-vijay.github.io/choudalao.github.io/posts/2021-01-12-%E8%BD%ACmysql%E5%8D%83%E4%B8%87%E6%95%B0%E6%8D%AE%E7%BA%A7%E5%88%86%E8%A1%A8%E8%AE%BE%E8%AE%A1%E5%8F%8A%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88/</link><pubDate>Tue, 12 Jan 2021 15:05:21 +0800</pubDate><guid>https://galloping-vijay.github.io/choudalao.github.io/posts/2021-01-12-%E8%BD%ACmysql%E5%8D%83%E4%B8%87%E6%95%B0%E6%8D%AE%E7%BA%A7%E5%88%86%E8%A1%A8%E8%AE%BE%E8%AE%A1%E5%8F%8A%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88/</guid><description>&lt;h1 id="理论"&gt;理论&lt;/h1&gt;
&lt;p&gt;针对系统数据表日渐增长的数据量，分库分表是减少数据库压力，增加db操作效率的常见解决方案。&lt;/p&gt;
&lt;p&gt;在讨论之前，先了解几个概念&lt;/p&gt;
&lt;h4 id="垂直分割"&gt;垂直分割&lt;/h4&gt;
&lt;p&gt;垂直拆分就是要把表按模块划分到不同数据库表中。&lt;/p&gt;</description></item><item><title>【转】tinyint(1)和tinyint(4)的区别和用法</title><link>https://galloping-vijay.github.io/choudalao.github.io/posts/2020-11-29-%E8%BD%ACtinyint1%E5%92%8Ctinyint4%E7%9A%84%E5%8C%BA%E5%88%AB%E5%92%8C%E7%94%A8%E6%B3%95/</link><pubDate>Sun, 29 Nov 2020 16:04:34 +0800</pubDate><guid>https://galloping-vijay.github.io/choudalao.github.io/posts/2020-11-29-%E8%BD%ACtinyint1%E5%92%8Ctinyint4%E7%9A%84%E5%8C%BA%E5%88%AB%E5%92%8C%E7%94%A8%E6%B3%95/</guid><description>&lt;p&gt;&lt;img src="https://www.choudalao.com/uploads/20201129/20201129160212ysHpzf.png" alt=""&gt;&lt;/p&gt;
&lt;p&gt;1 bytes = 8 bit ,一个字节最多可以代表的数据长度是2的8次方 11111111 在计算机中也就是&lt;/p&gt;
&lt;p&gt;-128到127&lt;/p&gt;
&lt;h3 id="bitm"&gt;BIT[M]&lt;/h3&gt;
&lt;p&gt;位字段类型，M表示每个值的位数，范围从1到64，如果M被忽略，默认为1&lt;/p&gt;</description></item><item><title>Docker安装Mysql 8.0</title><link>https://galloping-vijay.github.io/choudalao.github.io/posts/2020-11-02-docker%E5%AE%89%E8%A3%85mysql-80/</link><pubDate>Mon, 02 Nov 2020 23:21:21 +0800</pubDate><guid>https://galloping-vijay.github.io/choudalao.github.io/posts/2020-11-02-docker%E5%AE%89%E8%A3%85mysql-80/</guid><description>&lt;h1 id="前提"&gt;前提&lt;/h1&gt;
&lt;p&gt;已安装 docker&lt;/p&gt;
&lt;h1 id="查看可用的mysql镜像版本"&gt;查看可用的Mysql镜像版本&lt;/h1&gt;
&lt;p&gt;登陆 &lt;a href="https://hub.docker.com/"&gt;https://hub.docker.com/&lt;/a&gt;
搜索 &lt;code&gt;mysql&lt;/code&gt;,切换到tag标签,找到 mysql8.0
&lt;img src="https://www.choudalao.com/uploads/20230119/202301191637316A4hdz.png" alt=""&gt;
复制箭头的命令&lt;/p&gt;
&lt;h3 id="拉取镜像"&gt;拉取镜像&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a6e22e"&gt;docker&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;pull&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;mysql&lt;/span&gt;:&lt;span style="color:#ae81ff"&gt;8.0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src="https://www.choudalao.com/uploads/20230119/20230119163934MTTvEn.png" alt=""&gt;&lt;/p&gt;
&lt;h3 id="查看镜像"&gt;查看镜像&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a6e22e"&gt;docker&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;images&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src="https://www.choudalao.com/uploads/20230119/20230119163946qMTFhS.png" alt=""&gt;&lt;/p&gt;
&lt;h3 id="启动mysql镜像"&gt;启动Mysql镜像&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a6e22e"&gt;docker&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;run&lt;/span&gt; &lt;span style="color:#f92672"&gt;-&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;itd&lt;/span&gt; &lt;span style="color:#f92672"&gt;--&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;name&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;mysql&lt;/span&gt;&lt;span style="color:#f92672"&gt;-&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;8&lt;/span&gt; &lt;span style="color:#f92672"&gt;-&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;p&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;3307&lt;/span&gt;:&lt;span style="color:#ae81ff"&gt;3306&lt;/span&gt; &lt;span style="color:#f92672"&gt;-&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;e&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;MYSQL_ROOT_PASSWORD&lt;/span&gt;=&lt;span style="color:#ae81ff"&gt;123456&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;mysql&lt;/span&gt;:&lt;span style="color:#ae81ff"&gt;8.0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;参数说明：&lt;/p&gt;
&lt;p&gt;–name mysql-8：所建容器的名称
-p 3307:3306 ：映射容器服务的 3306 端口到宿主机的 3307 端口，外部主机可以直接通过 宿主机ip:3307 访问到 MySQL 的服务。
MYSQL_ROOT_PASSWORD=123456：设置 MySQL 服务 root 用户的密码
mysql:8.0：使用的镜像，即镜像名：tag&lt;/p&gt;</description></item><item><title>MYSQL 慢查询 | 臭大佬</title><link>https://galloping-vijay.github.io/choudalao.github.io/posts/2020-09-07-mysql-%E6%85%A2%E6%9F%A5%E8%AF%A2-%E8%87%AD%E5%A4%A7%E4%BD%AC/</link><pubDate>Mon, 07 Sep 2020 11:28:11 +0800</pubDate><guid>https://galloping-vijay.github.io/choudalao.github.io/posts/2020-09-07-mysql-%E6%85%A2%E6%9F%A5%E8%AF%A2-%E8%87%AD%E5%A4%A7%E4%BD%AC/</guid><description>&lt;h1 id="数据库中设置sql慢查询"&gt;数据库中设置SQL慢查询&lt;/h1&gt;
&lt;h3 id="一第一步开启mysql慢查询"&gt;一、第一步.开启mysql慢查询&lt;/h3&gt;
&lt;p&gt;查看MySQL是否启用了查看慢SQL的日志文件
####（1） 查看慢SQL日志是否启用&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;mysql&amp;gt; show variables like &lt;span style="color:#e6db74"&gt;&amp;#39;log_slow_queries&amp;#39;&lt;/span&gt;; 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;+------------------+-------+
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;| Variable_name | Value |
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;+------------------+-------+
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;| log_slow_queries | ON |
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;+------------------+-------+
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt; row in set &lt;span style="color:#f92672"&gt;(&lt;/span&gt;0.00 sec&lt;span style="color:#f92672"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="2-查看执行慢于多少秒的sql会记录到日志文件中"&gt;（2） 查看执行慢于多少秒的SQL会记录到日志文件中&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;mysql&amp;gt; show variables like &lt;span style="color:#e6db74"&gt;&amp;#39;long_query_time&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;+-----------------+-------+
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;| Variable_name | Value |
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;+-----------------+-------+
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;| long_query_time | &lt;span style="color:#ae81ff"&gt;1&lt;/span&gt; | 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;+-----------------+-------+
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt; row in set &lt;span style="color:#f92672"&gt;(&lt;/span&gt;0.00 sec&lt;span style="color:#f92672"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;这里value&lt;span style="color:#f92672"&gt;=&lt;/span&gt;1， 表示1秒
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="二-配置myini文件inux下文件名为mycnf-查找到mysqld区段增加日志的配置如下示例"&gt;二. 配置my.ini文件（inux下文件名为my.cnf）， 查找到[mysqld]区段，增加日志的配置，如下示例：&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;[&lt;/span&gt;mysqld&lt;span style="color:#f92672"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;log&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;C:/temp/mysql.log&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;log_slow_queries&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;C:/temp/mysql_slow.log&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;long_query_time&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;log指示日志文件存放目录；
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;log_slow_queries指示记录执行时间长的sql日志目录；
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;long_query_time指示多长时间算是执行时间长，单位s。
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Linux下这些配置项应该已经存在，只是被注释掉了，可以去掉注释。但直接添加配置项也OK啦。&lt;/p&gt;</description></item><item><title>mysql和php字符长度判断</title><link>https://galloping-vijay.github.io/choudalao.github.io/posts/2020-04-29-mysql%E5%92%8Cphp%E5%AD%97%E7%AC%A6%E9%95%BF%E5%BA%A6%E5%88%A4%E6%96%AD/</link><pubDate>Wed, 29 Apr 2020 17:03:26 +0800</pubDate><guid>https://galloping-vijay.github.io/choudalao.github.io/posts/2020-04-29-mysql%E5%92%8Cphp%E5%AD%97%E7%AC%A6%E9%95%BF%E5%BA%A6%E5%88%A4%E6%96%AD/</guid><description>&lt;h1 id="问题"&gt;问题&lt;/h1&gt;
&lt;p&gt;最近工作中遇到一个问题，数据库字段设置的&lt;code&gt;varchar(255)&lt;/code&gt;，测试测的时候总是在临界点那边给我提bug，今天研究一下mysql和php字符长度判断。&lt;/p&gt;</description></item><item><title>数据库操作</title><link>https://galloping-vijay.github.io/choudalao.github.io/posts/2019-12-09-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/</link><pubDate>Mon, 09 Dec 2019 20:45:50 +0800</pubDate><guid>https://galloping-vijay.github.io/choudalao.github.io/posts/2019-12-09-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/</guid><description>&lt;h1 id="进入数据库win下-mysql--u-root--p"&gt;进入数据库(win下)( mysql -u root -p)&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;mysql &lt;span style="color:#f92672"&gt;-&lt;/span&gt;hlocalhost &lt;span style="color:#f92672"&gt;-&lt;/span&gt;uroot &lt;span style="color:#f92672"&gt;-&lt;/span&gt;p12345 &lt;span style="color:#f92672"&gt;//-&lt;/span&gt;p后面跟的是密码
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;#显示数据库&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;SHOW&lt;/span&gt; DATABASES;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;#打开数据库&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;USE db_name;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;#显示数据表&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;show&lt;/span&gt; tables;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;#创建库
##语法&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;CREATE&lt;/span&gt; DATABASES db_name;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;#删除数据库
#语法&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;DROP&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;DATABASE&lt;/span&gt; db_name;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;#创建表&lt;/p&gt;
&lt;h2 id="语法"&gt;语法:&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;CREATE&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;TABLE&lt;/span&gt; tb_name ( 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;column_name_1 column_type_1 &lt;span style="color:#66d9ef"&gt;constraints&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; column_name_2 column_type_2 &lt;span style="color:#66d9ef"&gt;constraints&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; column_name_3 column_type_3 &lt;span style="color:#66d9ef"&gt;constraints&lt;/span&gt;, 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ... 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; column_name_n column_type_n &lt;span style="color:#66d9ef"&gt;constraint&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; s)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="示例"&gt;示例:&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;CREATE&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;TABLE&lt;/span&gt; &lt;span style="color:#f92672"&gt;`&lt;/span&gt;hz_chat_user&lt;span style="color:#f92672"&gt;`&lt;/span&gt; (
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;`&lt;/span&gt;id&lt;span style="color:#f92672"&gt;`&lt;/span&gt; int(&lt;span style="color:#ae81ff"&gt;11&lt;/span&gt;) unsigned &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; AUTO_INCREMENT,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;`&lt;/span&gt;account&lt;span style="color:#f92672"&gt;`&lt;/span&gt; varchar(&lt;span style="color:#ae81ff"&gt;150&lt;/span&gt;) CHARACTER &lt;span style="color:#66d9ef"&gt;SET&lt;/span&gt; utf8mb4 &lt;span style="color:#66d9ef"&gt;COLLATE&lt;/span&gt; utf8mb4_unicode_ci &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;账号&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;`&lt;/span&gt;head_img&lt;span style="color:#f92672"&gt;`&lt;/span&gt; varchar(&lt;span style="color:#ae81ff"&gt;255&lt;/span&gt;) CHARACTER &lt;span style="color:#66d9ef"&gt;SET&lt;/span&gt; utf8mb4 &lt;span style="color:#66d9ef"&gt;COLLATE&lt;/span&gt; utf8mb4_unicode_ci &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;头像&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;`&lt;/span&gt;status&lt;span style="color:#f92672"&gt;`&lt;/span&gt; tinyint(&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;) &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;账号状态,1:启用,0:禁用&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;`&lt;/span&gt;password&lt;span style="color:#f92672"&gt;`&lt;/span&gt; varchar(&lt;span style="color:#ae81ff"&gt;255&lt;/span&gt;) CHARACTER &lt;span style="color:#66d9ef"&gt;SET&lt;/span&gt; utf8mb4 &lt;span style="color:#66d9ef"&gt;COLLATE&lt;/span&gt; utf8mb4_unicode_ci &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;密码&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;`&lt;/span&gt;tel&lt;span style="color:#f92672"&gt;`&lt;/span&gt; varchar(&lt;span style="color:#ae81ff"&gt;11&lt;/span&gt;) CHARACTER &lt;span style="color:#66d9ef"&gt;SET&lt;/span&gt; utf8mb4 &lt;span style="color:#66d9ef"&gt;COLLATE&lt;/span&gt; utf8mb4_unicode_ci &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;电话&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;`&lt;/span&gt;wechat&lt;span style="color:#f92672"&gt;`&lt;/span&gt; varchar(&lt;span style="color:#ae81ff"&gt;100&lt;/span&gt;) CHARACTER &lt;span style="color:#66d9ef"&gt;SET&lt;/span&gt; utf8mb4 &lt;span style="color:#66d9ef"&gt;COLLATE&lt;/span&gt; utf8mb4_unicode_ci &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;微信&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;`&lt;/span&gt;qq&lt;span style="color:#f92672"&gt;`&lt;/span&gt; varchar(&lt;span style="color:#ae81ff"&gt;13&lt;/span&gt;) CHARACTER &lt;span style="color:#66d9ef"&gt;SET&lt;/span&gt; utf8mb4 &lt;span style="color:#66d9ef"&gt;COLLATE&lt;/span&gt; utf8mb4_unicode_ci &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;QQ&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;`&lt;/span&gt;email&lt;span style="color:#f92672"&gt;`&lt;/span&gt; varchar(&lt;span style="color:#ae81ff"&gt;50&lt;/span&gt;) CHARACTER &lt;span style="color:#66d9ef"&gt;SET&lt;/span&gt; utf8mb4 &lt;span style="color:#66d9ef"&gt;COLLATE&lt;/span&gt; utf8mb4_unicode_ci &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;邮箱&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;`&lt;/span&gt;sex&lt;span style="color:#f92672"&gt;`&lt;/span&gt; tinyint(&lt;span style="color:#ae81ff"&gt;2&lt;/span&gt;) &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;-1&amp;#39;&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;性别,-1:保密,0:男,1:女&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;`&lt;/span&gt;delete_time&lt;span style="color:#f92672"&gt;`&lt;/span&gt; int(&lt;span style="color:#ae81ff"&gt;10&lt;/span&gt;) &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;删除时间戳&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;`&lt;/span&gt;create_time&lt;span style="color:#f92672"&gt;`&lt;/span&gt; int(&lt;span style="color:#ae81ff"&gt;10&lt;/span&gt;) &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;`&lt;/span&gt;update_time&lt;span style="color:#f92672"&gt;`&lt;/span&gt; int(&lt;span style="color:#ae81ff"&gt;10&lt;/span&gt;) &lt;span style="color:#66d9ef"&gt;NOT&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;NULL&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;PRIMARY&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;KEY&lt;/span&gt; (&lt;span style="color:#f92672"&gt;`&lt;/span&gt;id&lt;span style="color:#f92672"&gt;`&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;KEY&lt;/span&gt; &lt;span style="color:#f92672"&gt;`&lt;/span&gt;user_id&lt;span style="color:#f92672"&gt;`&lt;/span&gt; (&lt;span style="color:#f92672"&gt;`&lt;/span&gt;user_id&lt;span style="color:#f92672"&gt;`&lt;/span&gt;) &lt;span style="color:#66d9ef"&gt;USING&lt;/span&gt; BTREE,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;KEY&lt;/span&gt; &lt;span style="color:#f92672"&gt;`&lt;/span&gt;account_delete&lt;span style="color:#f92672"&gt;`&lt;/span&gt; (&lt;span style="color:#f92672"&gt;`&lt;/span&gt;account&lt;span style="color:#f92672"&gt;`&lt;/span&gt;,&lt;span style="color:#f92672"&gt;`&lt;/span&gt;delete_time&lt;span style="color:#f92672"&gt;`&lt;/span&gt;) &lt;span style="color:#66d9ef"&gt;USING&lt;/span&gt; BTREE
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;) ENGINE&lt;span style="color:#f92672"&gt;=&lt;/span&gt;InnoDB &lt;span style="color:#66d9ef"&gt;DEFAULT&lt;/span&gt; CHARSET&lt;span style="color:#f92672"&gt;=&lt;/span&gt;utf8mb4 &lt;span style="color:#66d9ef"&gt;COMMENT&lt;/span&gt;&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;用户基本信息表&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;#查看表定义&lt;/p&gt;</description></item><item><title>mysql中索引的使用</title><link>https://galloping-vijay.github.io/choudalao.github.io/posts/2018-10-29-mysql%E4%B8%AD%E7%B4%A2%E5%BC%95%E7%9A%84%E4%BD%BF%E7%94%A8/</link><pubDate>Mon, 29 Oct 2018 22:30:01 +0800</pubDate><guid>https://galloping-vijay.github.io/choudalao.github.io/posts/2018-10-29-mysql%E4%B8%AD%E7%B4%A2%E5%BC%95%E7%9A%84%E4%BD%BF%E7%94%A8/</guid><description>&lt;p&gt;&amp;lt;p style=&amp;quot;text-align: center;&amp;quot;&amp;gt;&amp;lt;img src=&amp;quot;http://www.choudalao.com/uploads/20190921/ul2zeDUAuIXXaiQoXnMCMeDQaU3T4CWR6PVDjxRp.jpeg&amp;quot; alt=&amp;quot;&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: justify;&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;div style=&amp;quot;text-align: center;&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;p style=&amp;quot;text-align: left;&amp;quot;&amp;gt;命名规则：表名_字段名&amp;lt;/p&amp;gt;1、需要加索引的字段，要在where条件中&amp;lt;br&amp;gt;2、数据量少的字段不需要加索引&amp;lt;br&amp;gt;3、如果where条件中是&amp;lt;span&amp;gt;&amp;lt;strong&amp;gt;&amp;lt;font color=&amp;quot;#cc0000&amp;quot;&amp;gt;OR&amp;lt;/font&amp;gt;&amp;lt;/strong&amp;gt;&amp;lt;/span&amp;gt;关系，加索引不起作用&amp;lt;br&amp;gt;4、符合最&amp;lt;span&amp;gt;&amp;lt;strong&amp;gt;&amp;lt;font color=&amp;quot;#cc0000&amp;quot;&amp;gt;左&amp;lt;/font&amp;gt;&amp;lt;/strong&amp;gt;&amp;lt;/span&amp;gt;原则&amp;lt;p&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: justify;&amp;quot;&amp;gt;https://segmentfault.com/q/1010000003984016/a-1020000003984281&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: justify;&amp;quot;&amp;gt;联合索引又叫复合索引。对于复合索引:Mysql从左到右的使用索引中的字段，一个查询可以只使用索引中的一部份，但只能是最左侧部分。例如索引是key index (a,b,c). 可以支持&amp;lt;font color=&amp;quot;#cc0000&amp;quot;&amp;gt;&amp;lt;span&amp;gt;&amp;lt;strong&amp;gt;a&amp;lt;/strong&amp;gt;&amp;lt;/span&amp;gt;&amp;amp;nbsp;|&amp;lt;span&amp;gt;&amp;lt;strong&amp;gt;&amp;amp;nbsp;a,b&amp;lt;/strong&amp;gt;&amp;lt;/span&amp;gt;|&amp;amp;nbsp;&amp;lt;span&amp;gt;&amp;lt;strong&amp;gt;a,b,c&amp;lt;/strong&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/font&amp;gt;&amp;amp;nbsp;3种组合进行查找，但不支持 b,c进行查找 .当最左侧字段是常量引用时，索引就十分有效。&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: justify;&amp;quot;&amp;gt;&amp;lt;br&amp;gt;两个或更多个列上的索引被称作复合索引。&amp;lt;br&amp;gt;利用索引中的附加列，您可以缩小搜索的范围，但使用一个具有两列的索引 不同于使用两个单独的索引。复合索引的结构与电话簿类似，人名由姓和名构成，电话簿首先按姓氏对进行排序，然后按名字对有相同姓氏的人进行排序。如果您知 道姓，电话簿将非常有用；如果您知道姓和名，电话簿则更为有用，但如果您只知道名不姓，电话簿将没有用处。&amp;lt;br&amp;gt;所以说创建复合索引时，应该仔细考虑列的顺序。对索引中的所有列执行搜索或仅对前几列执行搜索时，复合索引非常有用；仅对后面的任意列执行搜索时，复合索引则没有用处。&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: justify;&amp;quot;&amp;gt;http://blog.csdn.net/lmh12506/article/details/8879916&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: justify;&amp;quot;&amp;gt;&amp;amp;nbsp;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: justify;&amp;quot;&amp;gt;&amp;amp;nbsp;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: justify;&amp;quot;&amp;gt;当一个表有多条索引可走时,&amp;amp;nbsp; Mysql&amp;amp;nbsp; 根据查询语句的成本来选择走哪条索引, 联合索引的话, 它往往计算的是第一个字段(最左边那个), 这样往往会走错索引. 如:&amp;amp;nbsp;&amp;lt;br&amp;gt;索引Index_1(Create_Time, Category_ID), Index_2(Category_ID)&amp;amp;nbsp;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;如果每天的数据都特别多, 而且有很多category, 但具体每个category的记录不会很多.&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: justify;&amp;quot;&amp;gt;当查询SQL条件为select …where create_time ….and category_id=..时, 很可能不走索引Index_1, 而走索引Index_2, 导致查询比较慢.&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: justify;&amp;quot;&amp;gt;解决办法是将索引字段的顺序调换一下.&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: justify;&amp;quot;&amp;gt;http://www.cnblogs.com/krisy/archive/2013/07/12/3186258.html&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: justify;&amp;quot;&amp;gt;&amp;amp;nbsp;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: justify;&amp;quot;&amp;gt;&amp;lt;span lang=&amp;quot;EN-US&amp;quot;&amp;gt;&amp;amp;nbsp;创建索引&amp;lt;/span&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: justify;&amp;quot;&amp;gt;在执行&amp;lt;span lang=&amp;quot;EN-US&amp;quot;&amp;gt;CREATE TABLE语句时可以创建索引，也可以单独用&amp;lt;span lang=&amp;quot;EN-US&amp;quot;&amp;gt;CREATE INDEX或&amp;lt;span lang=&amp;quot;EN-US&amp;quot;&amp;gt;ALTER TABLE来为表增加索引。&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: justify;&amp;quot;&amp;gt;&amp;lt;span lang=&amp;quot;EN-US&amp;quot;&amp;gt;&amp;lt;span lang=&amp;quot;EN-US&amp;quot;&amp;gt;&amp;lt;span lang=&amp;quot;EN-US&amp;quot;&amp;gt;&amp;lt;span lang=&amp;quot;EN-US&amp;quot;&amp;gt;&amp;lt;span lang=&amp;quot;EN-US&amp;quot;&amp;gt;1．&amp;lt;span lang=&amp;quot;EN-US&amp;quot;&amp;gt;ALTER TABLE&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: justify;&amp;quot;&amp;gt;&amp;lt;span lang=&amp;quot;EN-US&amp;quot;&amp;gt;ALTER TABLE用来创建普通索引、&amp;lt;span lang=&amp;quot;EN-US&amp;quot;&amp;gt;UNIQUE索引或&amp;lt;span lang=&amp;quot;EN-US&amp;quot;&amp;gt;PRIMARY KEY索引。&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;text-align: justify;&amp;quot;&amp;gt;&amp;lt;span lang=&amp;quot;EN-US&amp;quot;&amp;gt;&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;pre lay-lang=&amp;quot;PHP&amp;quot;&amp;gt;&amp;lt;code class=&amp;quot;PHP&amp;quot;&amp;gt;ALTER TABLE table_name ADD INDEX index_name (column_list)&lt;/p&gt;</description></item><item><title>mysql批量删除相同前缀的表和修改表名</title><link>https://galloping-vijay.github.io/choudalao.github.io/posts/2017-10-27-mysql%E6%89%B9%E9%87%8F%E5%88%A0%E9%99%A4%E7%9B%B8%E5%90%8C%E5%89%8D%E7%BC%80%E7%9A%84%E8%A1%A8%E5%92%8C%E4%BF%AE%E6%94%B9%E8%A1%A8%E5%90%8D/</link><pubDate>Fri, 27 Oct 2017 12:40:44 +0800</pubDate><guid>https://galloping-vijay.github.io/choudalao.github.io/posts/2017-10-27-mysql%E6%89%B9%E9%87%8F%E5%88%A0%E9%99%A4%E7%9B%B8%E5%90%8C%E5%89%8D%E7%BC%80%E7%9A%84%E8%A1%A8%E5%92%8C%E4%BF%AE%E6%94%B9%E8%A1%A8%E5%90%8D/</guid><description>&lt;p&gt;&amp;lt;p&amp;gt;&amp;amp;nbsp;由于博客升级,要把原来的系统和数据全都替换掉,安装完之后发现原来的数据表全都还在,根据表名前缀的区别,可以批量的删掉原来的数据表,操作如下:&amp;lt;/p&amp;gt;&amp;lt;p&amp;gt;执行sql语句:&amp;lt;/p&amp;gt;&amp;lt;pre lay-lang=&amp;quot;JavaScript&amp;quot;&amp;gt;&amp;lt;code class=&amp;quot;JavaScript&amp;quot;&amp;gt;Select CONCAT( &amp;lsquo;drop table &amp;lsquo;, table_name, &amp;lsquo;;&amp;rsquo; )
FROM information_schema.tables
Where table_name LIKE &amp;lsquo;pre_%&amp;rsquo;;&amp;lt;/code&amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;p&amp;gt;&amp;lt;span&amp;gt;解释:like&lt;code&gt;pre_%&lt;/code&gt;,其中pre_为你需要删除的表前缀,根据你自己的需求修改,&amp;lt;/span&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p&amp;gt;执行查询,会自动把匹配的表生成出 drop table table_name这样的SQL语句,&amp;lt;/p&amp;gt;&amp;lt;p&amp;gt;运行结果如下:&amp;lt;/p&amp;gt;&amp;lt;p&amp;gt;&amp;lt;img src=&amp;quot;http://www.yuemeet.com/data/upload/2017-10-27/59f2a343ab8ba.png&amp;quot; title=&amp;quot;59f2a343ab8ba.png&amp;quot; alt=&amp;quot;59f2a343ab8ba.png&amp;quot; _src=&amp;quot;/data/upload/2017-10-27/59f2a343ab8ba.png&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p&amp;gt;批量复制一下到记事本或者et之类的编辑工具中,确定你的sql语句是否正确.这么一来也可以安全的审核一下语句,避免误操作.&amp;lt;/p&amp;gt;&amp;lt;p&amp;gt;最好用记事本打开,这样可以去掉样式,检查之后复制到sqlyog里面运行:&amp;lt;/p&amp;gt;&amp;lt;p&amp;gt;&amp;lt;img src=&amp;quot;http://www.yuemeet.com/data/upload/2017-10-27/59f2a7a5621d7.png&amp;quot; title=&amp;quot;59f2a7a5621d7.png&amp;quot; alt=&amp;quot;59f2a7a5621d7.png&amp;quot; &lt;em&gt;src=&amp;quot;/data/upload/2017-10-27/59f2a7a5621d7.png&amp;quot;&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p&amp;gt;ok,成功删除相同表前缀的文章了!&amp;lt;/p&amp;gt;&amp;lt;h3&amp;gt;拓展:&amp;lt;br&amp;gt;&amp;lt;/h3&amp;gt;&amp;lt;p&amp;gt;批量修改表前缀:&amp;lt;/p&amp;gt;&amp;lt;pre lay-lang=&amp;quot;JavaScript&amp;quot;&amp;gt;&amp;lt;code class=&amp;quot;JavaScript&amp;quot;&amp;gt;Select CONCAT( &amp;lsquo;ALTER TABLE &amp;lsquo;, table_name, &amp;lsquo;RENAME TO &amp;lsquo;, table_name,&amp;rsquo;;&amp;rsquo; )
FROM information_schema.tables
Where table_name LIKE &amp;lsquo;uc&lt;/em&gt;%&amp;rsquo;;&lt;br&gt;
&amp;lt;/code&amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;p&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;pre class=&amp;quot;brush:sql;toolbar:false;&amp;quot;&amp;gt;批量复制一下到记事本或者&amp;amp;nbsp;et之类的编辑工具中,然后批量替换&amp;amp;nbsp;RENAME&amp;amp;nbsp;TO&amp;amp;nbsp;uc&amp;amp;nbsp;成&amp;amp;nbsp;RENAME&amp;amp;nbsp;TO&amp;amp;nbsp;你想要的表前缀完成后&amp;amp;nbsp;再执行&amp;lt;br&amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;p&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/p&amp;gt;&lt;/p&gt;</description></item></channel></rss>